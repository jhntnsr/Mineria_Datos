Jhonatan Simón 999010164

Análisis Predictivo de Sexo de la Víctima mediante Random Forest

library(readxl)

data <- read_excel("D:\\Documentos\\Maestria\\Introduccion a la Mineria de Datos\\base-de-datos-violencia-intrafamiliar-ano-2024_v3.xlsx")

dataf <- data [,c("VIC_SEXO","VIC_EDAD","VIC_ALFAB","VIC_TRABAJA","VIC_DEDICA")]

install.packages("randomForest")

library(randomForest)

dataf$VIC_SEXO <- as.factor(dataf$VIC_SEXO)

dataf <- na.omit(dataf)

set.seed(100)

dataf <- dataf[sample(1:nrow(dataf)),]

index  <- sample(1:nrow(dataf),0.8*nrow(dataf))

train <- dataf[index,]
test <- dataf[-index,]



forest <- randomForest (VIC_SEXO ~ 
                  VIC_EDAD +
                  VIC_ALFAB +
                  VIC_TRABAJA +
                  VIC_DEDICA,
                data = train, 
                ntree = 100,
                mtry = 4
                        )

prueba <- predict (forest,test)
prueba

matriz <- table(test$VIC_SEXO, prueba)
matriz

pre <- sum(diag(matriz))/sum(matriz)
pre

persona <- data.frame(
  VIC_EDAD =c(18),
  VIC_ALFAB =c(2),
  VIC_TRABAJA =c(2),
  VIC_DEDICA =c(4)
)

result <- predict(forest, persona, type ="prob" )
result

plot(forest)
